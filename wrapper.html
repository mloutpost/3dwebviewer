<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LC Timberframes â€¢ 3D Model Viewer</title>
  <style>
    :root {
      --bg: #0b1020;
      --text: rgba(255, 255, 255, 0.92);
      --border: rgba(255, 255, 255, 0.14);
    }
    body {
      margin: 0;
      padding: 0;
      height: 100vh;
      background: var(--bg);
      color: var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, sans-serif;
      overflow: hidden;
    }
    #viewer-frame {
      border: none;
      width: 100%;
      height: 100%;
      background: #fff; /* Models often expect white bg or handle their own */
    }
  </style>
  <script src="https://app.metricslite.com/tracker-1.0.js" data-site-id="7a184184-bbf4-4ec1-81ba-8d738decb242"></script>
  </head>
<body>
  <iframe id="viewer-frame" title="Model Viewer" allowfullscreen sandbox="allow-same-origin allow-scripts allow-popups allow-forms" referrerpolicy="no-referrer"></iframe>

  <script>
    // Get 'model' param from URL
    const urlParams = new URLSearchParams(window.location.search);
    const modelPath = urlParams.get('model');
    
    if (!modelPath) {
      alert("No model specified.");
      window.location.href = "index.html";
    }

    const iframe = document.getElementById('viewer-frame');
    
    // Prevent iframe from navigating parent window
    // The sandbox attribute already prevents top-level navigation, but we add extra protection
    iframe.addEventListener('load', function() {
      try {
        // Intercept any link clicks within the iframe that might try to navigate
        const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
        if (iframeDoc) {
          const links = iframeDoc.querySelectorAll('a[href]');
          links.forEach(link => {
            link.addEventListener('click', function(e) {
              const href = this.getAttribute('href');
              // If link tries to navigate to wrapper or detail pages, prevent it
              if (href && (href.includes('wrapper.html') || href.includes('detail.html') || href.includes('index.html'))) {
                e.preventDefault();
                e.stopPropagation();
                return false;
              }
            }, true);
          });
        }
      } catch (e) {
        // Cross-origin restrictions - expected for some models
      }
    });
    
    iframe.src = modelPath;
  </script>
</body>
</html>
